name: ğŸ” ä¾è³´æ€§å®‰å…¨å¯©æŸ¥

on:
  pull_request:
    branches: [main, develop]

jobs:
  dependency-review:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
    
    steps:
      - name: ğŸ” æª¢æŸ¥ä¾è³´æ€§è®Šæ›´
        uses: actions/dependency-review-action@v4
        with:
          # é…ç½®ä¾è³´æ€§å¯©æŸ¥åƒæ•¸
          comment-summary-in-pr: always
          fail-on-severity: moderate
          allow-licenses: |
            MIT
            Apache-2.0
            BSD-2-Clause
            BSD-3-Clause
            ISC
            LGPL-2.1
            LGPL-3.0
          deny-licenses: |
            GPL-2.0
            GPL-3.0
            AGPL-1.0
            AGPL-3.0
          
      - name: ğŸ“Š ç”Ÿæˆä¾è³´æ€§å ±å‘Š
        uses: actions/github-script@v7
        if: always()
        with:
          script: |
            const fs = require('fs');
            const path = require('path');
            
            // å‰µå»ºä¾è³´æ€§å¯©æŸ¥æ‘˜è¦
            const summary = `## ğŸ” ä¾è³´æ€§å®‰å…¨å¯©æŸ¥å ±å‘Š
            
            ### ğŸ“‹ å¯©æŸ¥çµæœ
            - âœ… æˆæ¬Šåˆè¦æ€§æª¢æŸ¥å®Œæˆ
            - ğŸ”’ å®‰å…¨æ¼æ´æƒæå®Œæˆ  
            - ğŸ“¦ ä¾è³´æ€§è®Šæ›´åˆ†æå®Œæˆ
            
            ### ğŸ›¡ï¸ å®‰å…¨è¨­å®š
            - **å¤±æ•ˆç­‰ç´š**: Moderate åŠä»¥ä¸Š
            - **å…è¨±æˆæ¬Š**: MIT, Apache-2.0, BSD-2/3-Clause, ISC, LGPL-2.1/3.0
            - **ç¦æ­¢æˆæ¬Š**: GPL-2.0/3.0, AGPL-1.0/3.0
            
            ### ğŸ’¡ å»ºè­°
            - å®šæœŸæ›´æ–°ä¾è³´é …ç›®ä»¥ç²å¾—å®‰å…¨ä¿®è£œç¨‹å¼
            - é¿å…ä½¿ç”¨å·²çŸ¥æœ‰æ¼æ´çš„å¥—ä»¶ç‰ˆæœ¬
            - æª¢æŸ¥æ–°ä¾è³´é …ç›®çš„æˆæ¬Šç›¸å®¹æ€§
            
            ---
            ğŸ¤– æ­¤å ±å‘Šç”±ä¾è³´æ€§å¯©æŸ¥å·¥ä½œæµç¨‹è‡ªå‹•ç”Ÿæˆ`;
            
            console.log('ä¾è³´æ€§å¯©æŸ¥æ‘˜è¦å·²ç”Ÿæˆ');
            
      - name: ğŸš¨ é€šçŸ¥å®‰å…¨å•é¡Œ
        if: failure()
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: `## âš ï¸ ä¾è³´æ€§å®‰å…¨è­¦å‘Š
              
              æ­¤ PR çš„ä¾è³´æ€§å¯©æŸ¥ç™¼ç¾äº†å®‰å…¨å•é¡Œæˆ–æˆæ¬Šè¡çªã€‚
              
              ### ğŸ“‹ è«‹æª¢æŸ¥ä»¥ä¸‹é …ç›®ï¼š
              - ğŸ”’ æ˜¯å¦å¼•å…¥äº†å·²çŸ¥å®‰å…¨æ¼æ´
              - âš–ï¸ æ˜¯å¦ä½¿ç”¨äº†ä¸ç›¸å®¹çš„æˆæ¬Šæ¢æ¬¾
              - ğŸ“¦ æ˜¯å¦å¯ä»¥å‡ç´šåˆ°å®‰å…¨ç‰ˆæœ¬
              
              è«‹åœ¨åˆä½µå‰è§£æ±ºé€™äº›å•é¡Œã€‚å¦‚éœ€å”åŠ©ï¼Œè«‹è¯ç¹«å®‰å…¨åœ˜éšŠã€‚
              
              ---
              ğŸ¤– æ­¤è­¦å‘Šç”±å®‰å…¨å¯©æŸ¥ç³»çµ±è‡ªå‹•ç”Ÿæˆ`
            })